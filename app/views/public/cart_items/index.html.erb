<%= render 'public/header' %>
<div class="container">
	<span class="text-danger">
		<%= flash[:warning] %>
	</span>

	<div class="row">
		<div class="col-md-5">
			<h2>ショッピングカート</h2>
		</div>
		<div class="col-md-5"></div>
		<div class="col-md-2">
			<%= link_to "カートを空にする", cart_items_destroy_all_path, method: :delete, class:"btn btn-danger" %>
		</div>
	</div>

	<table class="table table-bordered">
		<thead>
			<th>商品名</th>
			<th>単価（税込）</th>
			<th>数量</th>
			<th>小計</th>
			<th></th>
		</thead>
		<% @cartitems.each do |cartitem| %>
			<tbody>
				<td><%= attachment_image_tag cartitem.item, :image, class: "item-images" %> <%= cartitem.item.name %></td>
				<td><%= ((cartitem.item.price * 1.1).ceil).to_s(:delimited) %>円</td>
				<%= form_with model:cartitem, url: cart_item_path(cartitem), method: :patch, local: true do |f| %>
				<td><%= f.number_field :amount %><%= f.submit "変更" %></td>
				<% end %>
				<td><%= ((cartitem.item.price * 1.1 * cartitem.amount).ceil).to_s(:delimited) %>円</td>
				<td><%= link_to "削除する", cart_item_path(cartitem), method: :delete, class: "btn btn-danger" %></td>
			</tbody>
		<% end %>
	</table>

	<div class="row">
		<div class="col-md-2">
			<%= link_to "買い物を続ける", items_path, class: "btn btn-primary" %>
		</div>
		<div class="col-md-8"></div>
		<div class="col-md-2">
			<table class="table table-bordered">
				<td>合計金額</td> <td><%= @price.to_s(:delimited) %>円</td>
			</table>
		</div>
	</div>
	<div class="row">
		<div class="col-md-4"></div>
		<div class="col-md-4">
			<%= link_to "情報入力に進む", new_order_path, class: "btn btn-success mx-auto d-block" %>
		</div>
		<div class="col-md-4"></div>
	</div>
</div><br><br>